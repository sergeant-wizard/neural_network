## RBM with CD

### 背景

[前回](https://github.com/sergeant-wizard/neural_network/tree/master/rbm)
のRBMにContrastive Divergenceを導入

### 結果

入力データを列方向に並べた行列 `input` を幾つか用意し、
それぞれの入力に対してネットワークが示す確率が正しいかを検証する。

input | Test No.
----- | --------
0 0 0 | 0
1 0 0 | 1
1 0 0, 0 1 0 | 2
1 0 0, 0 1 0, 0 0 1 | 3

#### Test No. 0

単一の入力に対してのみ高い確率を示すことを確認。

input | actual | expected
----- | ------ | --------
000   |  0.932 | 1
100   |  0.021 | 0
010   |  0.018 | 0
110   |  0.002 | 0
001   |  0.020 | 0
101   |  0.003 | 0
011   |  0.002 | 0
111   |  0.002 | 0

#### Test No. 1

単一の入力に対してのみ高い確率を示すことを確認。

input | actual | expected
----- | ------ | --------
000   | 0.007  | 0
100   | 0.961  | 1
010   | 0.001  | 0
110   | 0.014  | 0
001   | 0.001  | 0
101   | 0.016  | 0
011   | 0.000  | 0
111   | 0.001  | 0

#### Test No. 2
確率を示さないはずのパターンに対して高い確率を示してしまっている。
勾配消失の可能性があるので、今後モメンタムや重み減衰を試してみる。

input | actual | expected
----- | ------ | --------
000   | 0.343  | 0
100   | 0.238  | 0.5
010   | 0.217  | 0.5
110   | 0.149  | 0
001   | 0.020  | 0
101   | 0.013  | 0
011   | 0.012  | 0
111   | 0.008  | 0

