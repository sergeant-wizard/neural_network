## RBM

### 背景

8.5節のRBMの実装。
8章で説明されているボルツマシンのうち、4節以前のものは計算コストが現実的ではないが、
8.5節のRBMは工学的に応用され得るので、最初に実装するボルツマシンの例題としてRBMを選んだ。

### ネットワークの概要

直感的に挙動が正しいかどうか判別できる規模に抑える。

param | value
------------------------------------ | -----
Visible Layer のユニット数           | 3
Hidden Layer のユニット数            | 2
学習係数                             | 0.1
Gibbs Sampling の試行回数            | 1024
学習の反復数                         | 4096

### 結果

入力データを列方向に並べた行列 `input` を幾つか用意し、
それぞれの入力に対してネットワークが示す確率が正しいかを検証する。

input | Test No. | plausible
----- | -------- | ---------
0 0 0 | 0        | yes
1 1 1 | 1        | yes
1 0 0 | 2        | yes
0 0 0, 1 1 1 | 3 | no
0 0 0, 0 0 1 | 4 | yes
0 0 1, 0 1 0, 0 0 1 | 5 | yes
1 1 0, 1 0 1, 0 1 1 | 6 | yes

#### Test No. 0

単一の入力に対してのみ高い確率を示すことを確認。

input | actual | expected
----- | ------ | --------
000   | 0.997  | 1
100   | 0.001  | 0
010   | 0.001  | 0
110   | 0.000  | 0
001   | 0.001  | 0
101   | 0.000  | 0
011   | 0.000  | 0
111   | 0.000  | 0

#### Test No. 1

単一の入力に対してのみ高い確率を示すことを確認。

input | actual | expected
----- | ------ | --------
000   |  0.000 | 0
100   |  0.000 | 0
010   |  0.000 | 0
110   |  0.001 | 0
001   |  0.000 | 0
101   |  0.001 | 0
011   |  0.001 | 0
111   |  0.998 | 1

#### Test No. 2

単一の入力に対してのみ高い確率を示すことを確認。

input | actual | expected
----- | ------ | --------
000   | 0.001  | 0
100   | 0.998  | 1
010   | 0.000  | 0
110   | 0.001  | 0
001   | 0.000  | 0
101   | 0.001  | 0
011   | 0.000  | 0
111   | 0.000  | 0

#### Test No. 3

ネットワークが想起するパターンは正しいものの、
`000`と`111`の確率に差がでた。
極端な入力の違いに対し、ネットワークの自由度が不足しているのではないかと考察。

input | actual | expected
----- | ------ | --------
000   | 0.340  | 0.5
100   | 0.002  | 0
010   | 0.002  | 0
110   | 0.007  | 0
001   | 0.002  | 0
101   | 0.007  | 0
011   | 0.007  | 0
111   | 0.635  | 0.5

#### Test No. 4

２種類の入力に対して等しい確率を示し、想定通りの挙動を示すことを確認。

input | actual | expected
----- | ------ | --------
000   | 0.492  | 0.5
100   | 0.001  | 0
010   | 0.001  | 0
110   | 0.000  | 0
001   | 0.505  | 0.5
101   | 0.001  | 0
011   | 0.001  | 0
111   | 0.000  | 0

#### Test No. 5

2:1の比率で出現する入力に対し、想定通りの挙動を示すことを確認

input | actual | expected
----- | ------ | --------
000   | 0.010 | 0
100   | 0.000 | 0
010   | 0.325 | 0.333
110   | 0.002 | 0
001   | 0.652 | 0.667
101   | 0.000 | 0
011   | 0.010 | 0
111   | 0.000 | 0

#### Test No. 6

他のテストケースに比べるとやや入力していないパターンの確率が高いが、
反復回数を増やせば期待される確率に近づくことを確認。

input | actual | expected
----- | ------ | --------
000   | 0.000  | 0
100   | 0.032  | 0
010   | 0.006  | 0
110   | 0.302  | 0.333
001   | 0.031  | 0
101   | 0.283  | 0.333
011   | 0.287  | 0.333
111   | 0.059  | 0

### まとめ

7ケース中、6ケースで期待通りの挙動となることを確認した。
今後は contrastive divergence の効果や、
DBN, DBMへの拡張をしてみる。
